# cs4775-phylo

## Overview
In this repository, you will find all the code and datasets neccessary to reproduce the results presented in "Comparative Evaluation of Phylogenetic Reconstruction Methods for Coronavirus Genomes" (CS 4775 Final Project, Fall 2025). Here is an overview of contents of this repo:

- ```/trees``` directory: we include all
the fasta files with the DNA sequences as well as the generated trees in Newick format. 
- Our Python reimplementation of Fitch's algorithm ``fitchs_algorithm.py`` to calculate parsimony score for a given tree (Newick format)
- Code to calculate RF distances between any pair of trees (Newick format) ``rf_distance.py``.

The code in this repository is in Python, and uses a couple pip packages which can be installed using our requirements.txt file.
```
pip install -r requirements.txt
```

## Computational Pipeline
We describe the computational pipeline and how to run it.

1. The first step in our pipeline is to download sequences of SARS-COV-2 from [National Center for Biotechnology Information (NCBI)](https://www.ncbi.nlm.nih.gov/datasets/genome/?taxon=2697049&assembly_level=3:3).
2. Next, we perform alignment with [MUSCLE](https://github.com/rcedgar/muscle).
3. Then, we generate trees using 3 phylogenetic methods (IQ-TREE, FastTree, BEAST).
    -  IQ-TREE and FastTree can be installed with conda
    ```
    conda install -c bioconda {iqtree / fastree}
    ```
    - BEAST must be downloaded directly from its source code i.e. [here](https://beast.community/install_on_unix). In our case, BEAST was already installed on the BioHPC cluster.
4. We describe how each phylogenetic reconstruction method was run on the BioHPC cluster (with ex. fasta file):
  - IQ-TREE [instructions](https://biohpc.cornell.edu/lab/userguide.aspx?a=software&i=494#c): ```mpirun -np 10 /programs/iqtree-2.2.0/bin/iqtree2-mpi -s 252-fasta-input-file.fas -m GTR+G -nt 8```
  - FastTree [instructions](https://biohpc.cornell.edu/lab/userguide.aspx?a=software&i=195#c): ``FastTree -nt 252-fasta-input-file.fas > FastTree-252-tree.nwk``
  - BEAST: We used exactly [these instructions](https://biohpc.cornell.edu/lab/userguide.aspx?a=software&i=1207#c) to run it.
5. We also download the `trees/paper-generated-*` tree files from this paper [Phylogenetic reconstruction of the initial stages of the spread of the SARS-CoV-2 virus in the Eurasian and American continents by analyzing genomic data](https://www.sciencedirect.com/science/article/pii/S0168170221002586). We compare the parsimony scores and pairwise RF-Distances for the trees we generate with these paper generated trees as well.
6. After the trees are generated (in Newick format), we turn our attention to comparing them. First, we run Fitch's algorithm to calculate parsimony scores (see "Running Fitch's Algorithm" section).
7. Next, we calculate the Robinson-Fould (RF) distance for each pair of trees that we generated (see "Calculating RF-Distances" section below).
8. We now compare the trees using parsimony scores, RF-distances, runtime, and maximum likelihood for IQ-TREE and FastTree.

## Data Details
- ``trees/paper-*`` files are Newick formats for trees generated by a paper (i.e. not directly generated by us). 3 files.
- ``trees/{method}-{seq_data}-tree.tre`` are Newick format trees which were generated by ``method`` (BEAST, FastTree, IQ-Tree) on ``seq_data`` (prelim, 252, full) in increasing size. 9 files.

These 12 tree files are the ones for which parsimony scores and RF-distances are reported in Tables 1 and 2 in our final report.

## Running Fitch's Algorithm
To run Fitch's algorithm, use the following terminal command
```
python fitchs_algorithm.py --newick-tree "trees-{newick-file}" --fasta-file "trees/252-fasta-input-file.fas" —-normalize-labels
```

## Calculating RF-Distances
To calculate RF-Distance between `tree1` and `tree2`, run:

```
python rf_distance.py --t1 "trees/{tree1} --t2 "trees/{tree2}
```

Note that this calculates unweighted, symmetric RF-distance. To reproduce the results of Table 2 in our report (pairwise distances for all pairs of trees), you can run the Bash script:
```
sh ./calc_rf_dist.sh
```

## Authors
- Deniz Bölöni-Turgut (Computer Science, 2026, db823)
- EJ Hunt (Operations Research and Information Engineering, 2026, ekh56)
- Mac Turner (Computer Science, 2026, mbt52)
- Leane Ying (Computer Science, 2026, ly374)